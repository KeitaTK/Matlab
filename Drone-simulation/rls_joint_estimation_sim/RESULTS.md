# rls_joint_estimation_sim - 実装完了報告

## 概要
交互RLS＋勾配法によるA/B/C/ω同時推定シミュレーションを実装し、評価を完了しました。

## 実装内容

### スクリプト
1. **rls_joint_estimator.m** - 交互RLS＋勾配法によるジョイント推定器
   - A,B,C: RLS（標準的な再帰的最小二乗法）
   - ω: 勾配降下法（誤差の偏微分を利用）
   - 数値安定化: クリッピング [0.1, 20] rad/s、指数平滑化

2. **generate_damped_sine.m** - 減衰正弦信号生成器

3. **run_sim_joint.m** - シミュレーション実行スクリプト
   - デフォルト設定: fs=100Hz, f_true=0.8Hz, gamma=5e-2, alpha_omega=0.1

4. **plot_results_joint.m** - 結果可視化
   - 信号比較、周波数推定、A/B/C推移、誤差・共分散

5. **sweep_params_joint.m** - パラメータスイープ

## ベースライン結果
- **収束時間**: 4.98 s（初期ω=0.6Hz → 真値0.8Hz）
- **定常誤差**: -0.0002 Hz（最後10秒の平均）
- **条件**: ノイズなし、decay=0.01、γ=5e-2、α_ω=0.1

## パラメータスイープ結果

### 1. gamma（学習率）の影響
| gamma | 収束時間 [s] | 定常誤差 [Hz] |
|-------|-------------|--------------|
| 1e-3  | 47.13       | -0.0018      |
| 5e-3  | 17.60       | -0.0002      |
| 1e-2  | 11.99       | -0.0002      |
| 5e-2  | **4.98**    | **-0.0002**  |
| 1e-1  | 3.35        | -0.0002      |

**結論**: γ≥5e-2で高速収束、1e-1でも安定

### 2. ノイズ振幅の影響
| noise_amp | 収束時間 [s] | 定常誤差 [Hz] | 標準偏差 [Hz] |
|-----------|-------------|--------------|--------------|
| 0.00      | 4.98        | -0.0002      | 0.0011       |
| 0.01      | 4.98        | -0.0004      | 0.0017       |
| 0.05      | 5.01        | -0.0016      | 0.0083       |
| 0.10      | 4.74        | 0.0005       | 0.0134       |
| 0.20      | 4.67        | -0.0036      | 0.0370       |

**結論**: ノイズ耐性良好、0.2でもバイアス<0.5%、収束時間ほぼ不変

### 3. 初期ωの影響
| omega_init [Hz] | 収束時間 [s] | 定常誤差 [Hz] |
|-----------------|-------------|--------------|
| 0.4             | 11.34       | -0.0002      |
| 0.5             | 7.67        | -0.0002      |
| 0.6             | 4.98        | -0.0002      |
| 0.7             | **3.66**    | -0.0002      |
| 1.0             | 4.21        | -0.0002      |
| 1.2             | 7.86        | -0.0002      |

**結論**: 真値に近い初期値で高速、遠方からも確実に収束

### 4. decay（減衰率）の影響
| decay | 収束時間 [s] | 定常誤差 [Hz] |
|-------|-------------|--------------|
| 0.001 | 4.65        | -0.0000      |
| 0.005 | 4.71        | -0.0001      |
| 0.010 | 4.98        | -0.0002      |
| 0.020 | 5.09        | -0.0005      |
| 0.050 | 5.71        | -0.0012      |

**結論**: 減衰が強いと定常誤差がやや増加（振幅低下の影響）、収束時間はほぼ不変

## 推奨パラメータ
- **gamma**: 5e-2 〜 1e-1（収束速度重視）
- **alpha_omega**: 0.1（平滑化と応答性のバランス）
- **lambda**: 0.995（標準的なRLS忘却係数）
- **P0**: diag([1e3, 1e3, 1e3])

## まとめ
✅ 交互RLS＋勾配法による**A/B/C/ω同時推定が成功**  
✅ 収束時間 **3〜5秒**（0.8Hz信号、100Hzサンプリング）  
✅ 定常誤差 **<0.001 Hz**（ノイズなし）  
✅ ノイズ振幅0.2でも実用的な精度  
✅ 初期値ロバスト性良好（±50%誤差からも収束）

## 生成ファイル
- `results/`: 26個のMAT/CSV/PNG（ベースライン1回 + スイープ25回）
- すべてのプロットにメタデータ（パラメータ、収束時間、誤差）を注釈

---
作成日時: 2026年1月17日
