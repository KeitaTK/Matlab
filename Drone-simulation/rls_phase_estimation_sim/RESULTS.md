# RLS位相バッファ法による周波数推定
## 実験結果サマリー

**実験日**: 2026年1月19日  
**手法**: RLS + 位相バッファ解析（勾配法不使用）

---

## ✅ 主要な成果

### 1. 高速収束
- **最速**: 3.7秒（α_ω=0.2）
- **推奨**: 7.5秒（α_ω=0.05、最良バランス）

### 2. 高精度
- **定常誤差**: 0.00018 Hz（0.022%）
- **定常標準偏差**: 0.00057 Hz（0.071%）

### 3. 高いノイズ耐性
- ノイズ振幅0.2（20%）でもバイアス<0.1%
- 収束時間はノイズの影響をほぼ受けない

### 4. 広い収束域
- 初期値±50%誤差から確実に収束
- 定常性能は初期値に依存しない

---

## 📊 パラメータスイープ結果

### Sweep 1: 平滑化係数 α_ω

| α_ω | 収束時間 | 定常誤差 | 定常σ | 評価 |
|-----|---------|---------|------|------|
| 0.01 | 17.70s | 0.00021Hz | **0.00011Hz** | 最安定（遅い） |
| **0.05** | **7.50s** | **0.00018Hz** | **0.00057Hz** | **✅最適** |
| 0.1 | 5.04s | 0.00022Hz | 0.00118Hz | 高速 |
| 0.2 | 3.70s | 0.00018Hz | 0.00238Hz | 最速（振動） |
| 0.3 | 3.08s | 0.02263Hz | 0.25709Hz | ❌不安定 |

**推奨**: α_ω = 0.05（精度・速度のバランス最良）

### Sweep 2: ノイズ振幅

| ノイズ | 収束時間 | 定常誤差 | 定常σ | バイアス率 |
|-------|---------|---------|------|-----------|
| 0.0 | 5.04s | 0.00022Hz | 0.00118Hz | 0.03% |
| 0.01 | 5.05s | 0.00022Hz | 0.00233Hz | 0.03% |
| 0.05 | 5.03s | 0.00053Hz | 0.01248Hz | 0.07% |
| 0.1 | 5.05s | 0.00054Hz | 0.02096Hz | 0.07% |
| 0.2 | 5.04s | 0.00031Hz | 0.03093Hz | 0.04% |

**結論**: 極めて高いノイズ耐性

### Sweep 3: 初期周波数

| 初期値 | 誤差率 | 収束時間 | 定常誤差 |
|-------|-------|---------|---------|
| 0.4Hz | -50% | 10.03s | 0.00026Hz |
| 0.6Hz | -25% | 5.04s | 0.00022Hz |
| 0.9Hz | +12.5% | **3.59s** | 0.00028Hz |
| 1.2Hz | +50% | 7.43s | 0.00019Hz |

**結論**: ±50%誤差から収束可能

### Sweep 4: 減衰係数

| decay | 収束時間 | 定常誤差 | 定常σ |
|-------|---------|---------|------|
| 0.001 | 4.96s | **0.00002Hz** | 0.00088Hz |
| 0.01 | 5.04s | 0.00022Hz | 0.00118Hz |
| 0.05 | 5.72s | 0.00144Hz | 0.00009Hz |

**結論**: 減衰が緩やかなほど高精度

---

## 🆚 勾配法との比較

| 評価項目 | 位相バッファ法 | RLS+勾配法 | 優位 |
|---------|--------------|-----------|-----|
| 収束速度 | 3.7s～7.5s | 5.0s | ✅位相法 |
| 定常精度 | 0.00018Hz | 0.00020Hz | ≈同等 |
| ノイズ耐性（バイアス） | 優れる | 標準 | ✅位相法 |
| ノイズ耐性（分散） | 標準 | 優れる | 勾配法 |
| 実装容易性 | 高い | 中程度 | ✅位相法 |
| パラメータ調整 | 1個（α_ω） | 2個（γ, α_ω） | ✅位相法 |
| 計算コスト | やや高 | 低 | 勾配法 |

**総合評価**: 🏆 **位相バッファ法が総合的に優れている**

---

## 🎯 最適設定

### 速度重視
- α_ω = 0.2
- 収束時間: 3.7秒
- 定常誤差: 0.00018 Hz
- 定常σ: 0.00238 Hz

### バランス重視（推奨）
- **α_ω = 0.05**
- **収束時間: 7.5秒**
- **定常誤差: 0.00018 Hz**
- **定常σ: 0.00057 Hz**

### 精度重視
- α_ω = 0.01
- 収束時間: 17.7秒
- 定常誤差: 0.00021 Hz
- 定常σ: 0.00011 Hz

---

## 📁 生成されたファイル

### データファイル
- `results/v2_all_sweep_results.mat` - 全スイープ結果
- `results/detailed_analysis.mat` - 詳細分析データ
- `results/example_run.mat` - 実行例データ

### レポート
- `技術報告書.md` - 詳細な技術レポート（本文書の親）
- `results/detailed_report.txt` - テキスト形式の詳細レポート
- `results/sweep_summary.txt` - スイープサマリー

### 図表（`results/figures_v2/`）
1. `best_case_detailed.png` - ベストケース詳細プロット
2. `best_case_convergence.png` - 収束フェーズの拡大図
3. `sweep_alpha_summary.png` - α_ω スイープ結果
4. `sweep_noise_summary.png` - ノイズスイープ結果
5. `sweep_init_omega_summary.png` - 初期周波数スイープ結果
6. `sweep_decay_summary.png` - 減衰係数スイープ結果
7. `all_sweeps_comparison.png` - 全スイープの比較
8. `best_parameters_summary.png` - 最良パラメータのサマリー

### スクリプト（`scripts/`）
- `rls_phase_estimator.m` - コア推定アルゴリズム
- `generate_damped_sine.m` - テスト信号生成
- `run_parameter_sweep.m` - パラメータスイープ実行
- `analyze_sweep_results.m` - 結果分析
- `generate_detailed_analysis.m` - 詳細分析生成
- `create_summary_figures.m` - サマリー図表生成
- `plot_best_sweep_case.m` - ベストケース可視化

---

## 🚀 今後の展開

### 短期
1. リアルタイム実装への最適化
2. 組み込みシステムでの動作検証
3. 実データでの性能評価

### 中期
1. 複数周波数成分への拡張
2. 適応的バッファサイズの実装
3. 時変周波数への追従性能向上

### 長期
1. ドローン実機での外力推定への適用
2. 構造物モニタリングシステムへの展開
3. 回転機械の診断システムへの応用

---

**結論**: RLS位相バッファ法は、勾配法を使わずに高速・高精度な周波数推定を実現し、実装が容易で調整すべきパラメータも少ないため、**実用的な周波数推定手法として有望**です。
